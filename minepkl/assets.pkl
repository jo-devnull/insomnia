import "tags/category/@tags.pkl" as tags

const jsonRenderer = new JsonRenderer {}

function buildLang() = new Mapping<String, FileOutput> {
  ["category:lang/pt_br"] {
    value {
      for (key, tag in tags.toMap()) {
        ["tag.item.category.\(key)"] = tag.title
      }
    }
    renderer = jsonRenderer
  }
}

function buildTagModels() = new Mapping<String, FileOutput> {
  for (key, tag in tags.toMap()) {
    ["category:models/tag/item/\(key)"] {
      value { parent = tag.icon }
      renderer = jsonRenderer
    }
  }
}

function buildAssets(mod) = new Mapping<String, FileOutput> {
  for (location, val in mod.assets) {
    [location] {
      value = val
      renderer = jsonRenderer
    }
  }
}

output {
  files {
    ...buildLang()
    ...buildTagModels()
  }
}
